# PROPOSITION DE STRUCTURE DE BASE DE DONNÉES
# Système de Rapports des Établissements Scolaires - SA2R IEF LOUGA

================================================================================
ANALYSE COMPLÈTE DU FICHIER EXCEL base.xlsx
================================================================================

## ONGLETS IDENTIFIÉS :
1. Ref - Données de référence
2. Param - Paramètres
3. 1-Gene&Finan - Données Générales et Financières
4. 2-Effectifs - Effectifs des élèves
5. 3-CI&CMG&CFEE - Examens et recrutement
6. 4-Personnel - Personnel enseignant
7. 5-Mat&Mob - Matériel et Mobilier
8. Feuil2 - Liste établissements

================================================================================
STRUCTURE PROPOSÉE EN TABLES
================================================================================

### TABLE PRINCIPALE : rapports
- id (PK)
- etablissement_id (FK -> etablissements)
- annee_scolaire (ex: "2024-2025")
- mois (ex: "Octobre")
- statut (brouillon, soumis, validé, rejeté)
- date_soumission
- date_validation
- validé_par (FK -> users admin)
- observations_admin
- created_at
- updated_at

================================================================================
SECTION 1 : DONNÉES GÉNÉRALES ET FINANCIÈRES
================================================================================

### TABLE : rapport_infos_directeur
- id (PK)
- rapport_id (FK)
- directeur_nom
- contact_1
- contact_2
- email_directeur
- distance_inspection (en km)

### TABLE : rapport_donnees_generales
- id (PK)
- rapport_id (FK)
# CPE (Comité de Parents d'Élèves)
- cpe_existe (oui/non)
- cpe_nombre
# Infrastructures de base
- cloture (oui/non)
- type_cloture (enum: grillage, mur, haie)
- eau (oui/non)
- type_eau (enum: robinet, puits, forage, citerne)
- electricite (oui/non)
- type_electricite (enum: senelec, solaire, groupe_electrogene)
- connexion_internet (oui/non)
- type_connexion_internet (enum: fibre, adsl, 4g, satellite)
- cantine_scolaire (oui/non)
- type_cantine (enum: interne, externe, communautaire)

### TABLE : rapport_cge (Comité de Gestion de l'École)
- id (PK)
- rapport_id (FK)
- cge_existe (oui/non)
- cge_hommes (int)
- cge_femmes (int)
- cge_total (int)
- president_nom
- president_contact
- tresorier_nom
- tresorier_contact

### TABLE : rapport_cgpe (Comité de Gestion de Point d'Eau)
- id (PK)
- rapport_id (FK)
- cgpe_existe (oui/non)
- cgpe_hommes
- cgpe_femmes
- cgpe_total
- president_nom
- president_contact

### TABLE : rapport_langues
- id (PK)
- rapport_id (FK)
- enseignement_langue_nationale (oui/non)
- nom_langue_nationale
- niveau_enseignement (CI, CP, CE1, CE2, CM1, CM2)

### TABLE : rapport_projets
- id (PK)
- rapport_id (FK)
- projets_existent (oui/non)
- nom_projets (text)

### TABLE : rapport_finances
- id (PK)
- rapport_id (FK)
# Ressources financières mobilisées
- cge_cotisations (decimal)
- cge_activites_generatrices (decimal)
- apport_partenaires (decimal)
- subvention_etat (decimal)
- autres_ressources (decimal)
- total_ressources (decimal, calculé)

================================================================================
SECTION 2 : EFFECTIFS DES ÉLÈVES (217 COLONNES!)
================================================================================

### TABLE : rapport_effectifs_classe
- id (PK)
- rapport_id (FK)
- niveau (enum: CI, CP, CE1, CE2, CM1, CM2)

# NOMBRE DE CLASSES
- nombre_classes (int)

# EFFECTIFS GLOBAUX
- effectif_garcons (int)
- effectif_filles (int)
- effectif_total (int, calculé)

# REDOUBLANTS
- redoublants_garcons (int)
- redoublants_filles (int)
- redoublants_total (int, calculé)

# ABANDONS
- abandons_garcons (int)
- abandons_filles (int)
- abandons_total (int, calculé)

# HANDICAPS - MOTEUR
- handicap_moteur_garcons (int)
- handicap_moteur_filles (int)
- handicap_moteur_total (int, calculé)

# HANDICAPS - VISUEL
- handicap_visuel_garcons (int)
- handicap_visuel_filles (int)
- handicap_visuel_total (int, calculé)

# HANDICAPS - SOURD/MUET
- handicap_sourd_muet_garcons (int)
- handicap_sourd_muet_filles (int)
- handicap_sourd_muet_total (int, calculé)

# HANDICAPS - DÉFICIENCE INTELLECTUELLE
- handicap_deficience_intel_garcons (int)
- handicap_deficience_intel_filles (int)
- handicap_deficience_intel_total (int, calculé)

# ORPHELINS
- orphelins_garcons (int)
- orphelins_filles (int)
- orphelins_total (int, calculé)

# SANS EXTRAIT DE NAISSANCE
- sans_extrait_garcons (int)
- sans_extrait_filles (int)
- sans_extrait_total (int, calculé)

# TOTAUX CALCULÉS AUTOMATIQUEMENT
- total_handicaps_garcons (calculé: somme de tous les handicaps garçons)
- total_handicaps_filles (calculé: somme de tous les handicaps filles)
- total_handicaps (calculé)

### VUES CALCULÉES / STATISTIQUES :
- Total école par niveau
- Total général garçons/filles/total
- Taux de redoublement par niveau et par genre
- Taux d'abandon par niveau et par genre
- Taux de scolarisation des enfants handicapés
- Taux d'enfants orphelins
- Taux d'enfants sans extrait de naissance
- Parité filles/garçons
- Évolution des effectifs

### NOTE IMPORTANTE :
Cette table capture 28 indicateurs par niveau x 6 niveaux = 168 colonnes
+ 30 colonnes de totaux école
+ métadonnées = 217 colonnes au total

Chaque rapport aura donc 6 enregistrements (un par niveau) + 1 ligne de totaux

================================================================================
SECTION 3 : EXAMENS ET RECRUTEMENT
================================================================================

### TABLE : rapport_recrutement_ci
- id (PK)
- rapport_id (FK)
# Recrutement Mai
- mai_garcons
- mai_filles
- mai_total
# Recrutement Octobre
- octobre_garcons
- octobre_filles
- octobre_total
# Statut recrutement
- statut_ci (enum: normal, faible, bon)

### TABLE : rapport_cmg (Cours Moyen Général - Classes multiniveaux)
- id (PK)
- rapport_id (FK)
- cmg_nombre (int)
- cmg_combinaison_1 (ex: "CM1-CM2")
- cmg_combinaison_2
- cmg_combinaison_3
- cmg_combinaison_autres

### TABLE : rapport_cfee (Certificat de Fin d'Études Élémentaires)
- id (PK)
- rapport_id (FK)
- nombre_candidats (int)
- dont_filles (int)
- nombre_admis (int)
- admis_filles (int)
# Calculés
- taux_reussite (decimal, %)
- taux_reussite_filles (decimal, %)

### TABLE : rapport_entree_6eme
- id (PK)
- rapport_id (FK)
- nombre_candidats
- dont_filles
- nombre_admis
- admis_filles
# Calculés
- taux_admission (decimal, %)

================================================================================
SECTION 4 : PERSONNEL ENSEIGNANT
================================================================================

### TABLE : rapport_personnel_specialite
- id (PK)
- rapport_id (FK)
- specialite (enum: FR, AR) # Français, Arabe
- hommes (int)
- femmes (int)
- total (int, calculé)

### TABLE : rapport_personnel_corps
- id (PK)
- rapport_id (FK)
- corps (enum: I, ID, VD, VA, CI, CID, CVD, CVA)
  # I=Instituteur, ID=Inst.Directeur, VD=Volontaire Directeur
  # VA=Volontaire Adjoint, CI=Contractuel Instituteur, etc.
- hommes (int)
- femmes (int)
- total (int)

### TABLE : rapport_personnel_diplomes
- id (PK)
- rapport_id (FK)
- diplome (enum: CAP, CEAP, BAC)
- hommes (int)
- femmes (int)
- total (int)

### TABLE : rapport_personnel_competences_tic
- id (PK)
- rapport_id (FK)
- logiciel (enum: WORD, EXCEL, POWERPOINT, INTERNET, PROGRAMMATION)
- niveau_aucun (int)
- niveau_faible (int)
- niveau_moyen (int)
- niveau_avance (int)

================================================================================
SECTION 5 : INFRASTRUCTURES IMMOBILIÈRES
================================================================================

### TABLE : rapport_capital_immobilier
- id (PK)
- rapport_id (FK)
- type_infrastructure (enum)
  # salles_dur, abris_provisoires, bloc_admin, magasin, salle_info,
  # bibliotheque, cuisine, refectoire, toilettes_enseignants,
  # toilettes_garcons, toilettes_filles, toilettes_mixtes,
  # logement_directeur, logement_gardien, autres
- total_nombre (int)
- en_bon_etat (int)

================================================================================
SECTION 6 : MATÉRIELS DIDACTIQUES
================================================================================

### TABLE : rapport_materiels_didactiques
- id (PK)
- rapport_id (FK)
- type_materiel (enum)
  # dicos_fr, dicos_ar, dicos_autre, regle_plate, equerre, compas,
  # rapporteur, decametre, chaine_arpenteur, boussole, thermometre,
  # kit_capacite, balance, globe, cartes_murales, planches_illustrees,
  # kit_materiel_scientifique, autres
- total_nombre (int)
- en_bon_etat (int)

================================================================================
SECTION 7 : CAPITAL MOBILIER
================================================================================

### TABLE : rapport_capital_mobilier
- id (PK)
- rapport_id (FK)
- type_mobilier (enum)
  # tables_bancs, bureau, chaise, armoire, tableau_mobile,
  # tableau_interactif, mat_drapeau, drapeau, tableau_mural
- total_nombre (int)
- en_bon_etat (int)

================================================================================
SECTION 8 : ÉQUIPEMENTS INFORMATIQUES
================================================================================

### TABLE : rapport_equipements_informatiques
- id (PK)
- rapport_id (FK)
- type_equipement (enum)
  # ordinateur_fixe, ordinateur_portable, tablette, imprimante_laser,
  # imprimante_jet_encre, imprimante_multifonction, photocopieuse,
  # videoprojecteur, autres
- total_nombre (int)
- en_bon_etat (int)

================================================================================
SECTION 9 : MANUELS SCOLAIRES (ÉLÈVES)
================================================================================

### TABLE : rapport_manuels_eleves
- id (PK)
- rapport_id (FK)
- niveau (enum: CI, CP, CE1, CE2, CM1, CM2)
- type_manuel (enum)
  # lecture_francais, maths, edd, dm (découverte du monde),
  # manuel_classe, livret_maison, livret_diplome_gradue, planche_alpha,
  # manuel_arabe, manuel_religion, autre_religion, autres
- nombre (int)

================================================================================
SECTION 10 : MANUELS DU MAÎTRE
================================================================================

### TABLE : rapport_manuels_maitre
- id (PK)
- rapport_id (FK)
- niveau (enum: CI, CP, CE1, CE2, CM1, CM2)
- type_manuel (enum)
  # lecture_francais, maths, edd, dm, guide_pedagogique,
  # guide_arabe_religieux, guide_langue_nationale, cahier_recits, autres
- nombre (int)

================================================================================
TABLES DE RÉFÉRENCE (DÉJÀ EXISTANTES)
================================================================================

- etablissements (déjà créée)
- users (déjà créée)
- arrondissements
- communes
- districts
- zones

================================================================================
TABLES POUR HISTORIQUE ET WORKFLOW
================================================================================

### TABLE : rapport_historique
- id (PK)
- rapport_id (FK)
- action (enum: création, modification, soumission, validation, rejet)
- effectue_par (FK -> users)
- ancien_statut
- nouveau_statut
- commentaire (text)
- created_at

### TABLE : rapport_commentaires
- id (PK)
- rapport_id (FK)
- section (nom de la table concernée)
- auteur_id (FK -> users)
- commentaire (text)
- statut (ouvert, résolu)
- created_at
- updated_at

================================================================================
RÉSUMÉ DU NOMBRE DE TABLES
================================================================================

TOTAL : environ 25 tables principales + tables de référence

Par section :
1. Général/Finance : 6 tables
2. Effectifs : 1 table (avec 6 niveaux)
3. Examens : 4 tables
4. Personnel : 4 tables
5. Infrastructures : 1 table (types différents)
6. Matériels : 1 table
7. Mobilier : 1 table
8. Informatique : 1 table
9. Manuels élèves : 1 table
10. Manuels maître : 1 table
11. Workflow : 3 tables

================================================================================
IMPLÉMENTATION PAR ÉTAPES RECOMMANDÉE
================================================================================

PHASE 1 : FONDATION (Semaine 1)
✓ Déjà fait : etablissements, users
- Table rapports (principale)
- Tables workflow (historique, commentaires)

PHASE 2 : DONNÉES GÉNÉRALES (Semaine 2)
- rapport_infos_directeur
- rapport_donnees_generales
- rapport_cge
- rapport_cgpe
- rapport_langues
- rapport_projets
- rapport_finances

PHASE 3 : EFFECTIFS ET EXAMENS (Semaine 3)
- rapport_effectifs_classe
- rapport_recrutement_ci
- rapport_cmg
- rapport_cfee
- rapport_entree_6eme

PHASE 4 : PERSONNEL (Semaine 4)
- rapport_personnel_specialite
- rapport_personnel_corps
- rapport_personnel_diplomes
- rapport_personnel_competences_tic

PHASE 5 : INFRASTRUCTURES ET MATÉRIELS (Semaine 5)
- rapport_capital_immobilier
- rapport_materiels_didactiques
- rapport_capital_mobilier
- rapport_equipements_informatiques

PHASE 6 : MANUELS (Semaine 6)
- rapport_manuels_eleves
- rapport_manuels_maitre

================================================================================
NOTES IMPORTANTES
================================================================================

1. NORMALISATION :
   - Utiliser des ENUM pour les valeurs fixes
   - Créer des tables de référence pour les listes réutilisables
   - Éviter la duplication des données

2. VALIDATION :
   - Règles de validation au niveau modèle Laravel
   - Vérification des totaux calculés
   - Contraintes d'intégrité référentielle

3. PERFORMANCE :
   - Indexer les clés étrangères
   - Créer des vues matérialisées pour statistiques
   - Utiliser le cache pour les rapports

4. INTERFACE UTILISATEUR :
   - Formulaire multi-étapes (wizard)
   - Sauvegarde automatique (brouillon)
   - Validation en temps réel
   - Barre de progression

5. SÉCURITÉ :
   - Chaque établissement ne voit que ses rapports
   - Admin voit tous les rapports
   - Logs d'audit complets

================================================================================
FIN DU DOCUMENT
================================================================================
